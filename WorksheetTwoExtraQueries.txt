SELECT AVG(Price) AS Average_Price
FROM PRODUCT;

WITH 
BOOK_TRANSACTIONS AS (
    SELECT *
    FROM BOOK
    INNER JOIN TRANSACTION
    ON BOOK.ITEM_NUMBER = TRANSACTION.PRODUCT_NUMBER
),
BOOK_COUNT AS (
    SELECT Customer_ID, COUNT(Customer_ID) AS Count_Customer_ID
    FROM TRANSACTION
    GROUP BY Customer_ID
),
CUSTOMER_BOOK_COUNT AS (
    SELECT *
    FROM BOOK_COUNT
    INNER JOIN CUSTOMER
    ON BOOK_COUNT.Customer_ID = CUSTOMER.Loyalty_No
)
SELECT Customer_Name, Loyalty_No, MAX(Count_Customer_ID) AS Max_Count_Customer_ID
FROM CUSTOMER_BOOK_COUNT
GROUP BY Customer_Name, Loyalty_No;


SELECT E.Manager_ID
FROM EMPLOYEE_MANAGER AS E
INNER JOIN STORE_MANAGER AS S
ON E.Manager_ID = S.Manager_ID;
